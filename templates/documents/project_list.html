{% extends "_base.html" %}
{% block content %}
<div class="max-w-2xl mx-auto px-4 py-10">
  <h1 class="text-2xl font-semibold text-heading mb-8">My projects</h1>

  <form method="post" action="{% url 'project_list' %}" class="max-w-xl mb-16">
    {% csrf_token %}
    <div class="mb-5">
      <label for="project-name" class="block mb-2.5 text-sm font-medium text-heading">New project name</label>
      <input type="text" name="name" id="project-name" placeholder="e.g. My TTO Project" required
             class="bg-neutral-secondary-medium border border-default-medium text-heading text-sm rounded-base focus:ring-brand focus:border-brand block w-full px-3 py-2.5 shadow-xs placeholder:text-body">
    </div>
    <button type="submit" class="text-white bg-brand box-border border border-transparent hover:bg-brand-strong focus:ring-4 focus:ring-brand-medium shadow-xs font-medium leading-5 rounded-base text-sm px-4 py-2.5 focus:outline-none">
      Create project
    </button>
  </form>

  <h2 class="text-sm font-medium text-heading mb-3">Your projects</h2>
  <div class="w-full text-sm font-medium text-heading bg-neutral-primary-soft border border-default rounded-base">
    {% for project in projects %}
    <div class="flex items-center w-full px-4 py-3 border-b border-default last:border-b-0 hover:bg-neutral-secondary-medium group {% if forloop.first %}rounded-t-base{% endif %} {% if forloop.last %}rounded-b-base{% endif %}">
      <a href="{% url 'project_detail' project_id=project.uuid %}" class="flex-1 flex items-center min-w-0 cursor-pointer hover:text-fg-brand focus:outline-none focus:ring-2 focus:ring-brand focus:text-fg-brand rounded-base">
        <svg class="w-4 h-4 me-2 shrink-0 text-body" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 16H5a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v1M9 12h10m-6 4h6"/></svg>
        <span class="truncate">{{ project.name }}</span>
      </a>
      <div class="relative shrink-0 ms-2">
        <button type="button" class="inline-flex items-center justify-center w-8 h-8 text-body hover:bg-neutral-tertiary rounded-base focus:outline-none focus:ring-2 focus:ring-brand" aria-label="Project options" data-dropdown-toggle="dropdown-project-{{ project.uuid }}">
          <svg class="w-5 h-5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path d="M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"/></svg>
        </button>
        <div id="dropdown-project-{{ project.uuid }}" class="z-50 hidden min-w-40 bg-neutral-primary-soft border border-default-medium rounded-base shadow-lg py-1">
          <form method="post" action="{% url 'project_delete' project_id=project.uuid %}" class="p-0">
            {% csrf_token %}
            <button type="submit" class="inline-flex items-center w-full px-4 py-2 text-sm text-fg-danger hover:bg-neutral-tertiary rounded-base text-left" onclick="return confirm('Are you sure you want to delete this project?');">
              Delete
            </button>
          </form>
        </div>
      </div>
    </div>
    {% empty %}
    <p class="px-4 py-6 text-body text-sm">No projects yet. Create one above.</p>
    {% endfor %}
  </div>
</div>
{% endblock %}
